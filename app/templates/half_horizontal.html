<style>
  /* Half-horizontal PID layout (800×240) — two-panel design */
  .hh-wrap {
    display: flex;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  /* ── LEFT PANEL (next departure + stopping pattern) ── */
  .hh-left {
    flex: 0 0 70%;
    display: flex;
    flex-direction: column;
    padding-right: 10px;
    border-right: 2px solid var(--black);
    overflow: hidden;
    min-width: 0;
  }

  /* Next departure header */
  .hh-next {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--gray-60, #bbb);
    flex-shrink: 0;
  }

  .hh-next-info {
    flex: 1;
    min-width: 0;
  }

  .hh-dest {
    font-family: 'Inter', sans-serif;
    font-size: 24px;
    font-weight: 700;
    line-height: 1.1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .hh-meta {
    font-family: 'Inter', sans-serif;
    font-size: 11px;
    font-weight: 400;
    color: var(--gray-25, #555);
    margin-top: 2px;
  }

  /* Stopping pattern grid */
  .hh-stops {
    flex: 1;
    display: flex;
    align-items: flex-start;
    overflow: hidden;
    margin-top: 5px;
    gap: 0;
  }

  .hh-col {
    flex: 1;
    min-width: 0;
    padding-left: 7px;
    border-left: 2px solid var(--gray-45, #888);
  }

  .hh-col:first-child {
    border-left: none;
    padding-left: 0;
  }

  .hh-stop {
    font-family: 'Inter', sans-serif;
    font-size: 10.5px;
    font-weight: 400;
    line-height: 1.55;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--black);
  }

  .hh-stop.is-current {
    font-weight: 700;
    background: var(--black);
    color: var(--white);
    padding: 0 3px;
  }

  .hh-stop.is-express {
    color: var(--gray-50, #999);
    font-style: italic;
  }

  /* ── RIGHT PANEL (following departures + clock) ── */
  .hh-right {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding-left: 10px;
    overflow: hidden;
    min-width: 0;
  }

  .hh-following {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .hh-dep-row {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 3px 0;
    border-bottom: 1px solid var(--gray-65, #ccc);
    overflow: hidden;
  }

  .hh-dep-row:last-child {
    border-bottom: none;
  }

  .hh-dep-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 4px;
  }

  .hh-dep-time {
    font-family: 'Inter', sans-serif;
    font-size: 10px;
    color: var(--gray-25, #555);
    white-space: nowrap;
    flex-shrink: 0;
  }

  .hh-dep-dest {
    font-family: 'Inter', sans-serif;
    font-size: 13px;
    font-weight: 700;
    flex: 1;
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .hh-dep-badge {
    background: var(--black);
    color: var(--white);
    padding: 2px 7px;
    font-family: 'Inter', sans-serif;
    font-size: 11px;
    font-weight: 600;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .hh-dep-type {
    font-family: 'Inter', sans-serif;
    font-size: 10px;
    color: var(--gray-25, #555);
    margin-top: 1px;
  }

  /* Clock */
  .hh-clock {
    border: 2px solid var(--black);
    text-align: center;
    padding: 4px 6px;
    flex-shrink: 0;
    margin-top: 4px;
  }

  .hh-clock-time {
    font-family: 'Inter', sans-serif;
    font-size: 21px;
    font-weight: 700;
    line-height: 1;
  }
</style>

<div class="layout layout--col layout--stretch-x">
  {% if departures %}
  <div class="hh-wrap">

    <!-- LEFT: next departure + stopping pattern -->
    <div class="hh-left">
      <div class="hh-next">
        <div class="hh-next-info">
          <div class="hh-dest">{{ departures[0].destination }}</div>
          <div class="hh-meta">{{ departures[0].train_type }} · Platform {{ departures[0].platform }}</div>
        </div>
      </div>

      {% if stop_columns %}
      <div class="hh-stops">
        {% for col in stop_columns %}
        <div class="hh-col">
          {% for stop in col %}
          <div class="hh-stop {% if stop.is_current %}is-current{% elif stop.is_express %}is-express{% endif %}">
            {{ stop.name }}
          </div>
          {% endfor %}
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>

    <!-- RIGHT: following departures + clock -->
    <div class="hh-right">
      <div class="hh-following">
        {% for dep in departures[1:3] %}
        <div class="hh-dep-row">
          <div class="hh-dep-top">
            <span class="hh-dep-time">{{ dep.scheduled_time }}</span>
            <span class="hh-dep-dest">{{ dep.destination }}</span>
            {% set t2 = dep.estimated_time.split(' ') %}
            <span class="hh-dep-badge">{{ t2[0] }} {{ t2[1] }}</span>
          </div>
          <div class="hh-dep-type">{{ dep.train_type }}</div>
        </div>
        {% endfor %}
      </div>

      <div class="hh-clock">
        <div class="hh-clock-time">{{ updated_at }}</div>
      </div>
    </div>

  </div>
  {% endif %}
</div>

<div class="title_bar">
  <img class="image" src="https://cdn.getminted.cc/transitvic_black.png" />
  <span class="title">{{ station_name }}</span>
  <span class="instance">Updated {{ updated_at }}</span>
</div>
